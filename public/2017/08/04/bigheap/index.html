<!doctype html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta content="yes" name="apple-mobile-web-app-capable">
  <meta content="black" name="apple-mobile-web-app-status-bar-style">
  <meta content="telephone=no" name="format-detection">
  <meta name="keywords" content="C++ python 大并发网络 逆向">
  <meta name="description" content="重剑无锋，大巧不工">
  <meta name="author" content="恋恋风辰">

  
  <title>大根堆的原理与实现。</title>
  

  <link rel="alternate" href="/atom.xml" title="恋恋风辰的个人博客" type="application/atom+xml">
  <link rel="canonical" href="http://www.limerence2017.com/2017/08/04/bigheap/index.html">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="//at.alicdn.com/t/font_pb2xepysv85gsyvi.css">
  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>


  <body>
    <aside class="aside">
  <nav class="aside-menu">
    <ul class="aside-list">
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-wendang"></i><a href="/index.html" class="aside-menu-link" title="首页">首页</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-wendang1"></i><a href="/archives/index.html" class="aside-menu-link" title="所有文章">所有文章</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-biaoqian1"></i><a href="/tags/index.html" class="aside-menu-link" title="文章分类">文章分类</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-lianjie"></i><a href="/links/index.html" class="aside-menu-link" title="我和我的小伙伴">我和我的小伙伴</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-guanyu"></i><a href="/about/index.html" class="aside-menu-link" title="作者简介">作者简介</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-rss"></i><a href="/atom.xml" class="aside-menu-link" title="RSS">RSS</a></li>
        
      
    </ul>
  </nav>

  <article class="aside-show">
    
      <form class="search-from" id="search-from">
  <input class="search-text" id="search-text" type="text" name="searchText" value="" autocomplete="off">
  <button class="search-btn" id="search-btn" type="button"><i class="search-btn-icon iconfont icon-sousuo-sousuo"></i></button>
</form>

      <article class="search-data" id="search-data">
  <button class="search-close" id="search-close"><i class="search-close-icon iconfont icon-houdongfangiconfont10"></i></button>

  <div class="search-wrapper" id="search-wrapper"></div>
</article>

    
    <div class="aside-show-wrapper">
      <figure class="aside-avatar">
        <img src="/img/avatar.png" alt="avatar" class="aside-avatar-img">
        <figcaption class="aside-avatar-caption">
          恋恋风辰
          
          <strong class="aside-avatar-STRONG">个人博客</strong>
          
        </figcaption>
      </figure>
      <p class="aside-show-description">重剑无锋，大巧不工。</p>
      <ul class="aside-show-info">
        <li class="aside-show-item">
          <a href="javascript: void(0);" class="aside-show-link" title="微信" target="_blank"><i class="aside-show-icon iconfont icon-iconfontweixin"></i></a>
          <div class="aside-show-outside aside-show-outside_1">
            <img class="aside-show-IMG aside-show-IMG_1" src="/img/weixin.png" alt="微信">
          </div>
        </li>
        <li class="aside-show-item"><a href="https://www.zhihu.com/people/wang-wu-chen-32/activities" class="aside-show-link" title="知乎" target="_blank"><i class="aside-show-icon iconfont icon-zhihu"></i></a></li>
        <li class="aside-show-item"><a href="https://github.com/secondtonone1" class="aside-show-link" title="github" target="_blank"><i class="aside-show-icon iconfont icon-github"></i></a></li>
        <li class="aside-show-item">
          <a href="javascript: void(0);" class="aside-show-link" title="QQ" target="_blank"><i class="aside-show-icon iconfont icon-qq"></i></a>
          <div class="aside-show-outside">
            <img class="aside-show-IMG" src="/img/qq.png" alt="QQ">
          </div>
        </li>
      </ul>
    </div>
  </article>
</aside>


    <article class="main" id="main">
      <article class="post min-height">
  
  <header class="post-header">
    
    <h1 class="post-title">大根堆的原理与实现。</h1>
    <p class="post-meta">
      <span class="post-time">2017-08-04</span>
      
      <a href="/categories/tech/" title="技术开发" class="post-categories">技术开发</a>
      
      
      <a href="/tags/C/"" title="C++" class="post-tags"><i class="post-tags-icon iconfont icon-biaoqian"></i>C++</a>
      
      <a href="/tags/数据结构和算法/"" title="数据结构和算法" class="post-tags"><i class="post-tags-icon iconfont icon-biaoqian"></i>数据结构和算法</a>
      
    </p>
    
  </header>
  <div class="post-content"><h2 id="大根堆的定义："><a href="#大根堆的定义：" class="headerlink" title="大根堆的定义："></a>大根堆的定义：</h2><p>1 <code>大根堆是一个大根树</code><br>2 <code>大根堆是一个完全二叉树</code><br>所以大根堆用数组表示是连续的，不会出现空白字段。</p>
<h2 id="对于大根堆的插入"><a href="#对于大根堆的插入" class="headerlink" title="对于大根堆的插入"></a>对于大根堆的插入</h2><p><img src="/2017/08/04/bigheap/1.jpg" alt="1"><br>对于大根堆的插入，可以在排序前确定大根堆的形状，可以确定元素5从位置6插入，那么比较元素5和位置3的元素2，</p>
<p>元素5比元素2大，将2下移。接着比较元素5和元素20，一次类推，直到找到元素5的合理位置。</p>
<p>接着看一下如果插入的元素是21，怎么进行排序。<br><a id="more"></a><br><img src="/2017/08/04/bigheap/2.jpg" alt="2"><br>21比2大，所以将2下移，接着比较21和20，发现20比21小，20下移，最终21放到</p>
<p>根的位置。形成大根堆。</p>
<h2 id="对于大根堆的删除"><a href="#对于大根堆的删除" class="headerlink" title="对于大根堆的删除"></a>对于大根堆的删除</h2><p><img src="/2017/08/04/bigheap/3.jpg" alt="3"><br>大根堆删除根元素，那么可以确定删除后的形状。可以理解成将最后一个叶子节点放在</p>
<p>合理位置，首先比较叶子节点元素10和根节点的两个孩子15和2，选出两个节点中最大的</p>
<p>元素15,15比10大，所以15进行气泡。放到根节点。然后15所在的位置2,变为不确定的问号。</p>
<p>由于14比10大，那么14起泡放到位置2，根据大根堆的形状，最后将10放到左节点</p>
<h2 id="将一个无序的完全二叉树变为大根堆"><a href="#将一个无序的完全二叉树变为大根堆" class="headerlink" title="将一个无序的完全二叉树变为大根堆"></a>将一个无序的完全二叉树变为大根堆</h2><p><img src="/2017/08/04/bigheap/4.jpg" alt="4"><br>将一个无序的完全二叉树变为大根堆(或者小根堆)，首先要找到最有一个叶子节点的父节点，</p>
<p>对该父节点为根节点的子树进行排序，生成一个大根堆(小根堆)。然后从节点位置依次</p>
<p>向前做同样的排序，将该节点到根节点的所有子树变为大根堆(小根堆)<br>举例子：<br><img src="/2017/08/04/bigheap/5.jpg" alt="5"><br>如上图所示，因为总共有6个节点，6/2 = 3,所以元素19的父节点是位置3的元素4，</p>
<p>将以4位根的子树变为大根堆。因为19比4大，所以19上移，4做叶子节点。依次类推，</p>
<p>从位置3到位置1的所有子树都按照这种逻辑处理，最终变成大根堆。</p>
<p>接着要处理位置2的子树，位置2的元素为1，两个节点为25和12，选最大的元素25，因为</p>
<p>25比1大，所以25进行上移，1变为叶子节点。这样位置2的子树就处理完了。</p>
<p>接着处理位置1，因为位置1的元素为6，两个节点分别为25和19，取最大节点元素25，</p>
<p>因为25比6大，所以25上移，而此时位置2还有两个节点元素1和元素12，需要比较元素6</p>
<p>和这两个节点中最大的，以确定大根堆。由于12比6大，所以12上移，6变为叶子节点。</p>
<p>最终用数组表示这个大根堆就是[25,12,19,1,6,4]</p>
<h2 id="下面是代码实现和测试："><a href="#下面是代码实现和测试：" class="headerlink" title="下面是代码实现和测试："></a>下面是代码实现和测试：</h2><h3 id="大根堆的类结构："><a href="#大根堆的类结构：" class="headerlink" title="大根堆的类结构："></a>大根堆的类结构：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></div><div class="line"><span class="class"><span class="title">class</span> <span class="title">maxHeap</span></span></div><div class="line"><span class="class">&#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    maxHeap(<span class="keyword">void</span>)</div><div class="line">    &#123;</div><div class="line">        m_nHeapSize = <span class="number">0</span>;</div><div class="line">            m_nHeapCapacity = <span class="number">0</span>;</div><div class="line">            m_pHeapArray = <span class="literal">NULL</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    maxHeap(<span class="keyword">const</span> maxHeap&amp; tempHeap);</div><div class="line">    maxHeap(T * heapArray, <span class="keyword">int</span> arrayLen);</div><div class="line"></div><div class="line">    ~maxHeap()&#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(m_pHeapArray)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">free</span>(m_pHeapArray);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        m_pHeapArray = <span class="literal">NULL</span>;</div><div class="line">        m_nHeapSize = <span class="number">0</span>;</div><div class="line">        m_nHeapCapacity = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//插入节点</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertNode</span><span class="params">(<span class="keyword">const</span> T&amp; t)</span></span>;</div><div class="line">   <span class="comment">//pop堆顶元素</span></div><div class="line">    <span class="function"><span class="keyword">const</span> T&amp; <span class="title">popRoot</span><span class="params">()</span></span>;</div><div class="line">    <span class="comment">//打印自己的堆元素，用数组表示法输出</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printHeap</span><span class="params">()</span></span>;</div><div class="line">    <span class="comment">//将一个无序的数组变为大根堆</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createMaxHeap</span><span class="params">(T * heapArray, <span class="keyword">int</span> arrayLen)</span></span>;</div><div class="line">    <span class="comment">//销毁自己的堆元素</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deallocMaxHeap</span><span class="params">()</span></span>;</div><div class="line">    <span class="comment">//打印数组的元素</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printHeap</span><span class="params">(T * heapArray, <span class="keyword">int</span> arrayLen)</span></span>;</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="comment">//堆的数组元素，连续区间首地址</span></div><div class="line">    T*  m_pHeapArray;</div><div class="line">    <span class="comment">//当前使用的大小</span></div><div class="line">    <span class="keyword">int</span> m_nHeapSize;</div><div class="line">    <span class="comment">//堆的容量，实际开辟的大小</span></div><div class="line">    <span class="keyword">int</span> m_nHeapCapacity;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="两个构造函数："><a href="#两个构造函数：" class="headerlink" title="两个构造函数："></a>两个构造函数：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></div><div class="line"><span class="class"><span class="title">maxHeap</span>&lt;T&gt;:</span>:maxHeap(<span class="keyword">const</span> maxHeap  &amp;tempHeap)&#123;</div><div class="line">    m_nHeapSize = tempHeap.m_nHeapSize;</div><div class="line">    m_pHeapArray = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(class maxHeap) *m_nHeapSize);</div><div class="line">    m_nHeapCapacity = m_nHeapSize;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></div><div class="line"><span class="class"><span class="title">maxHeap</span>&lt;T&gt;:</span>:maxHeap(T * heapArray, <span class="keyword">int</span> arrayLen)</div><div class="line">&#123;</div><div class="line">    m_nHeapSize = arrayLen;</div><div class="line">    m_pHeapArray = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(class maxHeap) * m_nHeapSize);</div><div class="line">    m_nHeapCapacity = arrayLen;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="插入节点"><a href="#插入节点" class="headerlink" title="插入节点"></a>插入节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></div><div class="line"><span class="class"><span class="title">void</span> <span class="title">maxHeap</span>&lt;T&gt;:</span>:insertNode(<span class="keyword">const</span> T&amp; node)</div><div class="line">&#123;</div><div class="line">    m_nHeapSize ++;</div><div class="line">    <span class="keyword">if</span>(m_nHeapSize &gt;= m_nHeapCapacity)</div><div class="line">    &#123;</div><div class="line">        m_pHeapArray = (T *)<span class="built_in">realloc</span>(m_pHeapArray, <span class="keyword">sizeof</span>(T) * m_nHeapSize *<span class="number">2</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    m_nHeapCapacity = m_nHeapSize*<span class="number">2</span>;</div><div class="line"></div><div class="line">    <span class="comment">//当前节点所在位置</span></div><div class="line">    <span class="keyword">int</span> currentIndex = m_nHeapSize;</div><div class="line">    <span class="comment">//该节点父节点所在位置</span></div><div class="line">    <span class="keyword">int</span> parentIndex = currentIndex/<span class="number">2</span>;</div><div class="line">    <span class="comment">//当前节点为根节点，跳出循环直接插入即可</span></div><div class="line">    <span class="keyword">while</span>(currentIndex != <span class="number">1</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="comment">//父节点元素小于该node，因为是大根堆，所以父节点下移</span></div><div class="line">        <span class="keyword">if</span>(m_pHeapArray[parentIndex <span class="number">-1</span>] &lt; node)</div><div class="line">        &#123;</div><div class="line">            <span class="comment">//父节点数据下移</span></div><div class="line">            m_pHeapArray[currentIndex - <span class="number">1</span>] = m_pHeapArray[parentIndex <span class="number">-1</span>];</div><div class="line">            <span class="comment">//更新当前节点位置，当前比较位置上移</span></div><div class="line">            currentIndex = currentIndex/<span class="number">2</span>;</div><div class="line">            <span class="comment">//父节点位置同样上移</span></div><div class="line">            parentIndex =  parentIndex/<span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//因为节点数是从1开始的，所以节点数-1表示数组中的位置</span></div><div class="line">    m_pHeapArray[currentIndex <span class="number">-1</span>] = node;</div><div class="line"></div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="打印元素"><a href="#打印元素" class="headerlink" title="打印元素"></a>打印元素</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></div><div class="line"><span class="class"><span class="title">void</span> <span class="title">maxHeap</span>&lt;T&gt;:</span>:printHeap()</div><div class="line">&#123;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt;<span class="string">"current max heap array is :"</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_nHeapSize; i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; m_pHeapArray[i] &lt;&lt; <span class="string">" "</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></div><div class="line"><span class="class"><span class="title">void</span> <span class="title">maxHeap</span>&lt;T&gt;:</span>:printHeap(T * heapArray, <span class="keyword">int</span> arrayLen)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt;<span class="string">"current max heap array is :"</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arrayLen; i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; heapArray[i] &lt;&lt; <span class="string">" "</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="pop堆顶的元素，取出最大值"><a href="#pop堆顶的元素，取出最大值" class="headerlink" title="pop堆顶的元素，取出最大值"></a>pop堆顶的元素，取出最大值</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></div><div class="line"><span class="class"><span class="title">const</span> <span class="title">T</span>&amp; <span class="title">maxHeap</span>&lt;T&gt;:</span>:popRoot()</div><div class="line">&#123;</div><div class="line">    <span class="comment">//先取出最后的叶子节点</span></div><div class="line">    <span class="keyword">const</span> T&amp; lastEle = m_pHeapArray[m_nHeapSize<span class="number">-1</span>];</div><div class="line">    </div><div class="line">    <span class="comment">//更新heapsize</span></div><div class="line">    m_nHeapSize --;</div><div class="line"></div><div class="line">    <span class="comment">//删除时需要从根节点开始，找到最大值起泡</span></div><div class="line">    <span class="keyword">int</span> currentIndex= <span class="number">1</span>;</div><div class="line">    <span class="comment">//当前节点的做孩子</span></div><div class="line">    <span class="keyword">int</span> leftChild = currentIndex *<span class="number">2</span>;</div><div class="line">    <span class="comment">//当前节点的孩子节点超过堆大小，说明该节点为叶子节点</span></div><div class="line">    <span class="keyword">while</span>(leftChild &lt;= m_nHeapSize)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> bigChild = leftChild;</div><div class="line">        <span class="comment">//取出两个孩子中大的孩子，然后将大的孩子节点数据上移</span></div><div class="line">        <span class="keyword">if</span>(leftChild &lt; m_nHeapSize &amp;&amp; m_pHeapArray[leftChild<span class="number">-1</span>] &lt; m_pHeapArray[leftChild])</div><div class="line">        &#123;</div><div class="line">            <span class="comment">//更新大孩子节点为右节点</span></div><div class="line">            bigChild = leftChild +<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//比较两个节点中大的孩子节点和取出的最后叶子节点，那个数值大</span></div><div class="line">        <span class="comment">//如果最后的叶子节点数值大，那么可以跳出循环,因为找到了lastEle的合理位置</span></div><div class="line">        <span class="comment">//剩余的树也是大根堆</span></div><div class="line">        <span class="keyword">if</span>(m_pHeapArray[bigChild <span class="number">-1</span>] &lt;= lastEle)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//大节点数据上移</span></div><div class="line">        m_pHeapArray[currentIndex <span class="number">-1</span>] = m_pHeapArray[bigChild<span class="number">-1</span>];</div><div class="line">        <span class="comment">//更新插入位置为当前大节点位置</span></div><div class="line">        currentIndex = bigChild;</div><div class="line">        leftChild = currentIndex *<span class="number">2</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    m_pHeapArray[currentIndex<span class="number">-1</span>] = lastEle;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> lastEle;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>将一个无序的数组元素，变为大根堆<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></div><div class="line"><span class="class"><span class="title">void</span> <span class="title">maxHeap</span>&lt;T&gt;:</span>:createMaxHeap(T * heapArray, <span class="keyword">int</span> arrayLen)</div><div class="line">&#123;</div><div class="line">    <span class="comment">//判断异常</span></div><div class="line">    <span class="keyword">if</span>(arrayLen &lt;= <span class="number">0</span> || heapArray == <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//从最后一个叶子节点的父节点开始，依次从该位置到根节点</span></div><div class="line">    <span class="comment">//例如该位置为3，那么位置3，位置2，位置1的根节点的子树依次处理为大根堆</span></div><div class="line"></div><div class="line">    <span class="keyword">int</span> currentIndex = arrayLen;</div><div class="line">    <span class="comment">//父节点位置</span></div><div class="line">    <span class="keyword">int</span> beginIndex =  currentIndex/<span class="number">2</span>;</div><div class="line">    <span class="comment">//依次处理，形成子树大根堆</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = beginIndex; i &gt; <span class="number">0</span>;  i--)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> rootEle = heapArray[i<span class="number">-1</span>];</div><div class="line"></div><div class="line">        <span class="keyword">int</span> curNode = i;</div><div class="line">        <span class="keyword">int</span> leftChild = i *<span class="number">2</span>;</div><div class="line">        <span class="keyword">while</span>(leftChild &lt;= arrayLen)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> bigChild = leftChild;</div><div class="line"></div><div class="line">            <span class="keyword">int</span> rootElePrint =  heapArray[leftChild<span class="number">-1</span>];</div><div class="line">            <span class="keyword">int</span> rightElePrint = heapArray[leftChild+<span class="number">1</span> <span class="number">-1</span>] ;</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(leftChild +<span class="number">1</span> &lt;= arrayLen &amp;&amp; heapArray[leftChild+<span class="number">1</span> <span class="number">-1</span>] &gt; heapArray[leftChild<span class="number">-1</span>])</div><div class="line">            &#123;</div><div class="line">                bigChild = leftChild +<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(heapArray[bigChild <span class="number">-1</span>] &lt;= rootEle )</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        </div><div class="line">             </div><div class="line">            heapArray[curNode <span class="number">-1</span>] = heapArray[bigChild <span class="number">-1</span>];</div><div class="line">            curNode = bigChild;</div><div class="line">            leftChild = curNode *<span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        heapArray[curNode <span class="number">-1</span>] = rootEle;</div><div class="line">        </div><div class="line"> 　&#125;   </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>源代码下载地址： <a href="http://download.csdn.net/detail/secondtonone1/9575112" target="_blank" rel="external">http://download.csdn.net/detail/secondtonone1/9575112</a></p>
</div>
    
      <p class="post-copyright">若无特别说明，本文系原创，<a class="post-copyright-link" href="https://creativecommons.org/licenses/by/4.0/deed.zh" title="署名-非商业性使用 4.0 (CC BY-NC 4.0)" target="_blank">署名-非商业性使用 4.0 (CC BY-NC 4.0)</a>协议，转载文章请注明来自<a class="post-copyright-link" href="/" title="恋恋风辰的个人博客" target="_blank">恋恋风辰的个人博客</a>，或链接上原文地址：<a class="post-copyright-link" href="http://www.limerence2017.com/2017/08/04/bigheap/" title="http://www.limerence2017.com/2017/08/04/bigheap/" target="_blank">http://www.limerence2017.com/2017/08/04/bigheap/</a></p>

      
      <div class="toc-wrapper">
        <div class="toc-scroll">
          <div class="toc-middle">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#大根堆的定义："><span class="toc-text">大根堆的定义：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#对于大根堆的插入"><span class="toc-text">对于大根堆的插入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#对于大根堆的删除"><span class="toc-text">对于大根堆的删除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#将一个无序的完全二叉树变为大根堆"><span class="toc-text">将一个无序的完全二叉树变为大根堆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#下面是代码实现和测试："><span class="toc-text">下面是代码实现和测试：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#大根堆的类结构："><span class="toc-text">大根堆的类结构：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#两个构造函数："><span class="toc-text">两个构造函数：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#插入节点"><span class="toc-text">插入节点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#打印元素"><span class="toc-text">打印元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pop堆顶的元素，取出最大值"><span class="toc-text">pop堆顶的元素，取出最大值</span></a></li></ol></li></ol>
          </div>
        </div>
      </div>
    
  
</article>

      <footer class="footer">
  <p class="footer-text">驱动于 <a href="https://hexo.io/zh-cn/" class="footer-link" title="Hexo">Hexo</a>，主题由 <a href="/about" class="footer-link" title="恋恋风辰">恋恋风辰</a> 设计移植而来</p>
  <p class="footer-text">&copy; 2016 - 2017 <a href="/about" class="footer-link" title="恋恋风辰">恋恋风辰</a> 保留部分版权</p>
</footer>

    </article>

    <script src="/js/to-top.js"></script>
    <script src="/js/search.js"></script>
  </body>
</html>
